# Project Study Guide: Self-Improving Coding Agent

## Overview
This project implements an autonomous coding agent using a **cyclic state machine** (LangGraph). Unlike linear scripts, it employs a feedback loop (Plan → Code → Execute → Reflect) to iteratively solve tasks and learn from mistakes.

## 1. The "Brain" (Control Flow)
**Goal:** Understand the lifecycle of a task and the decision logic.

*   **File:** [src/agent/graph.py](../self-improving-coding-agent/src/agent/graph.py)
*   **Key Concepts:**
    *   **State Machine:** Defined using `StateGraph(AgentState)`.
    *   **Nodes:** The distinct steps in the process:
        *   `planner`: Breaks down the task.
        *   `coder`: Writes the solution.
        *   `executor`: Runs the code in the sandbox.
        *   `reflector`: Analyzes failures.
    *   **Conditional Edge:** `check_execution_status` is the critical logic that decides whether to loop back (retry) or finish.

## 2. The "Blood" (Data Model)
**Goal:** Understand what data persists and mutates across the steps.

*   **File:** [src/agent/state.py](../self-improving-coding-agent/src/agent/state.py)
*   **Key Fields:**
    *   `plan`: The dynamic to-do list generated by the LLM.
    *   `current_code`: The actual code being iterated on.
    *   `history`: A list of `TaskMemory` objects (code, output, error, reflection). This acts as the "short-term memory" for the current session.

## 3. The "Hands" (Execution Environment)
**Goal:** Understand how the code actually runs safely.

*   **File:** [src/sandbox/runner.py](../self-improving-coding-agent/src/sandbox/runner.py)
*   **Key Concept: Sibling Containers**
    *   The agent does *not* run generated code inside itself.
    *   `_run_docker`: Spins up an ephemeral `python:3.10-slim` container for *each* execution request.
    *   It captures `stdout`/`stderr` and then destroys the container immediately.
    *   `_run_local`: A dangerous fallback using `subprocess` (only used if Docker is unavailable).

## 4. The "Memory" (RAG)
**Goal:** Understand how it learns from past mistakes (Long-term Memory).

*   **Files:**
    *   `src/agent/nodes.py` (specifically `retrieve_memory` and `save_memory`)
    *   `src/memory/vector_store.py`
*   **Mechanism:**
    *   **Retrieval:** Before planning, it queries **ChromaDB** for similar past tasks/errors.
    *   **Storage:** On success, it saves the *final* working solution.
    *   **Benefit:** This allows the agent to recall specific pitfalls (e.g., "I've solved a similar bug before, I should avoid X").

## 5. Infrastructure
**Goal:** Understand the deployment and container orchestration.

*   **File:** [docker-compose.yml](../self-improving-coding-agent/docker-compose.yml)
*   **Key Detail:**
    *   `- /var/run/docker.sock:/var/run/docker.sock`
    *   This mount is crucial. It gives the `agent` container access to the host's Docker daemon, enabling it to spawn the "Sibling Containers" described in Section 3.
